<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnostic NIRD - Quiz S√©quentiel</title>
    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Styles de base et personnalisation du quiz */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .nird-gradient { background-image: linear-gradient(to right, #2563eb, #10b981); }
        .quiz-container { min-height: 400px; }

        /* Styles sp√©cifiques pour l'effet s√©quentiel */
        #questionContainer {
            min-height: 200px; /* Assure une hauteur stable pendant la transition */
            padding: 1rem 0;
            opacity: 1;
            transition: opacity 0.5s ease-in-out;
        }

        .question-hidden { opacity: 0; }

        /* Style des options de r√©ponse */
        #questionContainer label {
            display: block;
            background: #f0f4ff; /* blue-50 */
            margin: 0.5rem 0;
            padding: 0.75rem;
            border-radius: 0.5rem; /* rounded-lg */
            cursor: pointer;
            transition: background-color 0.2s;
            border: 1px solid transparent;
        }

        #questionContainer label:hover {
            background: #e0e7ff; /* blue-100 */
        }
        
        /* Cacher le radio par d√©faut et styler la s√©lection */
        #questionContainer input[type="radio"] {
            display: none;
        }
        
        #questionContainer input[type="radio"]:checked + span {
            font-weight: 600;
            color: #1e40af; /* blue-800 */
        }

        #questionContainer input[type="radio"]:checked ~ label {
             background: #c7d2fe; /* blue-200 */
             border-color: #3b82f6; /* blue-500 */
        }
        
        /* Couleurs pour l'analyse */
        .success { color: #10b981; } /* teal-500 */
        .warning { color: #f59e0b; } /* amber-500 */
        .danger { color: #ef4444; } /* red-500 */
        
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

    <!-- Header et Navigation (identique aux autres pages) -->
    <header class="nird-gradient shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <h1 class="text-3xl font-extrabold text-white tracking-tight">
                D√©marche NIRD
            </h1>
            <nav class="space-x-4">
                <a href="acceuil.html" class="text-white font-medium hover:text-gray-200 transition duration-150">Accueil</a>
                <a href="quiz_famille.html" class="text-white font-medium hover:text-gray-200 transition duration-150">Les 3 Piliers</a>
                <a href="diagnostic.html" class="text-white font-medium hover:text-gray-200 transition duration-150 py-1 px-3 bg-blue-700 rounded-full border-b-2 border-white">Faire le Diagnostic</a>
            </nav>
        </div>
    </header>

    <!-- Contenu Principal - Quiz -->
    <main class="flex-grow max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="bg-white p-8 md:p-12 rounded-xl shadow-2xl quiz-container">
            <h2 class="text-3xl font-bold text-blue-700 mb-6 border-b pb-4">
                √âvaluation de l'√âquilibre Num√©rique de votre Enfant
            </h2>

            <!-- Formulaire du Quiz -->
            <form id="quizForm"> 
                <div id="questionContainer">
                    <p class="text-lg text-gray-500">Pr√©paration du diagnostic...</p>
                </div>
                
                <!-- Bouton S√©quentiel -->
                <button type="button" id="nextButton" disabled class="mt-8 px-6 py-3 bg-teal-500 hover:bg-teal-600 text-white font-semibold rounded-lg shadow-md w-full transition duration-150">
                    Suivant
                </button>
            </form>

            <!-- Section R√©sultat (cach√©e au d√©but) -->
            <section id="resultat" class="hidden mt-8 p-6 bg-green-50 rounded-lg border-l-4 border-green-500 text-center">
                <h3 class="text-2xl font-bold text-gray-900 mb-4">üìä Diagnostic Personnalis√©</h3>
                <p id="message" class="text-xl font-semibold"></p>
                <p id="details" class="mt-4 text-gray-700"></p>
            </section>

        </div>
    </main>

    <!-- Footer Commun -->
    <footer class="bg-gray-200 mt-12 py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-400">
            <p>&copy; 2024 D√©marche NIRD - Num√©rique √âducatif. Tous droits r√©serv√©s.</p>
            <p class="text-sm mt-2">Un projet pour l'autonomie et l'√©thique technologique des √©quipes √©ducatives.</p>
        </div>
    </footer>

<!-- Logique JavaScript pour le Quiz -->
<script>
    // 1. D√©finition des questions, options et scores
    const quizData = [
        {
            id: "q1",
            title: "1. Combien d'heures par jour votre enfant passe-t-il devant les √©crans (hors temps scolaire) ?",
            options: [
                { text: "0‚Äì1h", value: 1 },
                { text: "1‚Äì2h", value: 2 },
                { text: "2‚Äì4h", value: 3 },
                { text: "Plus de 4h", value: 4 }
            ]
        },
        {
            id: "q2",
            title: "2. A-t-il un acc√®s internet en autonomie totale (sans supervision ou filtre) ?",
            options: [
                { text: "Acc√®s limit√© et surveill√©", value: 1 },
                { text: "Acc√®s libre mais raisonnable", value: 2 },
                { text: "Acc√®s libre sans limite", value: 3 }
            ]
        },
        {
            id: "q3",
            title: "3. Comment r√©agit-il lorsqu‚Äôon lui demande d'arr√™ter les √©crans ?",
            options: [
                { text: "Il arr√™te facilement", value: 1 },
                { text: "Il r√¢le un peu mais ob√©it", value: 2 },
                { text: "Il refuse ou s'√©nerve fortement", value: 3 }
            ]
        },
        {
            id: "q4",
            title: "4. L'enfant utilise-t-il un √©cran (t√©l√©phone, tablette, console) dans l'heure qui pr√©c√®de le coucher ?",
            options: [
                { text: "Jamais / Tr√®s rarement", value: 1 },
                { text: "De temps en temps", value: 2 },
                { text: "Souvent ou tous les jours", value: 3 }
            ]
        },
        {
            id: "q5",
            title: "5. √ätes-vous certain que votre enfant ne consulte pas de contenus inappropri√©s (violents, sensibles, etc.) ?",
            options: [
                { text: "Oui, nous surveillons ou les filtres sont actifs", value: 1 },
                { text: "Nous n'avons pas v√©rifi√©, mais nous pensons que non", value: 2 },
                { text: "Non, c'est une inqui√©tude ou il y a un risque", value: 3 }
            ]
        },
        {
            id: "q6",
            title: "6. Combien d'activit√©s sans √©cran (sport, lecture, jeux de soci√©t√©) pratique-t-il chaque jour ?",
            options: [
                { text: "2 heures ou plus", value: 1 },
                { text: "1 √† 2 heures", value: 2 },
                { text: "Moins d'une heure", value: 3 }
            ]
        }
    ];

    let currentQuestionIndex = 0; // Index de la question en cours
    let totalScore = 0;           // Score cumul√©

    const questionContainer = document.getElementById('questionContainer');
    const nextButton = document.getElementById('nextButton');
    const resultatSection = document.getElementById('resultat');

    /**
     * 1. Affiche la question actuelle et g√®re l'effet de d√©filement (fondu).
     */
    function displayQuestion() {
        if (currentQuestionIndex >= quizData.length) {
            // Si toutes les questions sont pass√©es, lance l'analyse
            analyzeResults();
            return;
        }

        const currentQuestion = quizData[currentQuestionIndex];
        
        // Masque l'ancienne question (fondu sortant)
        questionContainer.classList.add('question-hidden');

        // D√©lai pour l'effet de disparition (500ms = dur√©e de la transition CSS)
        setTimeout(() => {
            
            let questionHTML = `<h3 class="text-xl font-semibold text-gray-900 mb-4">${currentQuestion.title}</h3>`;
            
            // G√©n√®re les options radio
            currentQuestion.options.forEach(option => {
                questionHTML += `
                    <label tabindex="0" class="flex items-center space-x-3">
                        <input type="radio" name="${currentQuestion.id}" value="${option.value}" class="form-radio h-5 w-5 text-blue-600" aria-labelledby="${currentQuestion.id}-${option.value}">
                        <span id="${currentQuestion.id}-${option.value}" class="text-gray-700">${option.text}</span>
                    </label>
                `;
            });
            
            // Injecte le nouveau contenu
            questionContainer.innerHTML = questionHTML;
            
            // Affiche la nouvelle question (fondu entrant)
            questionContainer.classList.remove('question-hidden');

            // R√©initialisation du bouton et √©couteur
            nextButton.disabled = true;
            nextButton.textContent = "Suivant";
            if (currentQuestionIndex === quizData.length - 1) {
                nextButton.textContent = "üìå Analyser mes r√©ponses";
            }

            // Ajoute un √©couteur au conteneur pour la s√©lection d'une option
            questionContainer.addEventListener('change', checkSelection);

        }, 500); 
    }

    /**
     * 2. V√©rifie si une option est s√©lectionn√©e pour activer le bouton "Suivant".
     */
    function checkSelection() {
        const radioGroupName = quizData[currentQuestionIndex].id;
        const selected = document.querySelector(`input[name="${radioGroupName}"]:checked`);
        
        nextButton.disabled = !selected;
    }


    /**
     * 3. G√®re le passage √† la question suivante.
     */
    function nextQuestion() {
        const currentQuestion = quizData[currentQuestionIndex];
        const radioGroupName = currentQuestion.id;
        const selectedInput = document.querySelector(`input[name="${radioGroupName}"]:checked`);
        
        // Si une r√©ponse est s√©lectionn√©e
        if (selectedInput) {
            // Stocke la r√©ponse et met √† jour le score total
            const value = Number(selectedInput.value);
            totalScore += value;
            
            // Passe √† la question suivante
            currentQuestionIndex++;
            
            // Affiche la nouvelle question (ou les r√©sultats)
            displayQuestion();
            
        } else {
            // Utilisation d'un modal ou d'un message d'erreur √† la place d'alert()
            // Pour cet exemple, nous allons utiliser une alerte interne au bouton/message.
            // Utilisation d'un message temporaire dans le bouton pour √©viter alert().
            const originalText = nextButton.textContent;
            nextButton.textContent = "‚ö†Ô∏è Veuillez choisir une option pour continuer.";
            nextButton.classList.add('bg-red-500', 'hover:bg-red-600', 'animate-pulse');
            setTimeout(() => {
                nextButton.textContent = originalText;
                nextButton.classList.remove('bg-red-500', 'hover:bg-red-600', 'animate-pulse');
            }, 1500);
        }
    }

    /**
     * 4. Calcule et affiche le diagnostic final.
     */
    function analyzeResults() {
        // Cache le formulaire
        document.getElementById("quizForm").classList.add("hidden");
        
        let message = "";
        let details = "";
        let messageClass = "";
        
        // Score total maximum = 19. Minimum = 6.
        
        if(totalScore <= 8){
            // Score de 6 √† 8 (Faible risque)
            message = "F√©licitations ! Vous √™tes d√©j√† tr√®s proche des principes NIRD.";
            messageClass = "success";
            details = "Vos pratiques num√©riques sont tr√®s saines. Votre enfant b√©n√©ficie d'un excellent √©quilibre entre temps d'√©cran et activit√©s sans √©cran. Nous vous encourageons √† partager vos bonnes pratiques !";
        }
        else if(totalScore <= 13){
            // Score de 9 √† 13 (Risque mod√©r√©)
            message = "Votre d√©marche est bonne, mais quelques ajustements pourraient am√©liorer l'√©quilibre NIRD.";
            messageClass = "warning";
            details = "Nous recommandons d'examiner attentivement deux piliers : le **Responsable** (s√©curit√© des contenus) et le **Durable** (temps d'√©cran avant le coucher). De petites modifications peuvent avoir un grand impact sur la concentration et le sommeil de votre enfant.";
        }
        else{
            // Score de 14 √† 19 (Risque √©lev√©)
            message = "Un travail important est n√©cessaire pour int√©grer les principes NIRD dans le quotidien num√©rique.";
            messageClass = "danger";
            details = "L'usage actuel pourrait nuire au bien-√™tre, √† la concentration et au d√©veloppement social. Nous vous conseillons de revoir en urgence : 1. Les **limites claires** sur le temps total d'√©cran (Pilier Durable). 2. La **supervision** de l'acc√®s √† internet (Pilier Responsable).";
        }

        // Affichage des r√©sultats
        resultatSection.classList.remove("hidden");
        resultatSection.className = `mt-8 p-6 rounded-lg border-l-4 text-center border-current bg-white shadow-lg ${messageClass}`;

        document.getElementById("message").innerHTML = `<span class="${messageClass}">${message}</span>`;
        document.getElementById("details").innerHTML = details;
    }

    // 5. Initialisation du quiz au chargement de la page
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Afficher la premi√®re question
        displayQuestion(); 
        
        // 2. Attacher l'√©v√©nement au bouton "Suivant"
        nextButton.addEventListener('click', nextQuestion);
    });
</script>
</body>
</html>